> 阅读：https://z.itpub.net/article/detail/CC3700B7B6B252FC6AFFB3BC03AB7C30

### 1.Redis 是什么?

- Redis（Remote Dictionary Server），即远程字典服务，是一个开源的使用 ANSI C 语言编写、支持网络、可基于内存亦可持久化的日志型、Key- Value 非关系型数据库，并提供多种语言的API。
-  Redis 的出现，很大程度补偿了memcached 这类 key/value 存储的不足，在部分场合可以对关系数据库起到很好的补充作用，它提供了Java， C/C++,C#,PHP,JavaScript,Perl,Object- C，Python，Ruby，Erlang 等客户端，使用很方便。

Redis是一个开源的<font color='red'>key-value</font>存储系统。它支持存储的value类型相对更多，包括string(字符串)、list(链表)、set(集合)、zset(sorted set --有序集合)和 hash（哈希类型）。

Redis是一个使用ANSI C编写的开源、包含多种数据结构、支持网络、基于内存、可选持久性的键值对存储数据库

### 2. Redis 有哪些应用场景?

缓存系统（“热点”数据：高频读、低频写）、排行榜、计数器、分布式会话、分布式锁、消息队列系统、社交网络、消息系统 和实时系统

- 1、缓存 
  - 缓存现在几乎是所有中大型网站都在用的必杀技，合理的利用缓存不仅能够提升网站访问速度，还能大大降低数据库的压力。Redis提供了键过期功能，也提供了灵活的键淘汰策略，所以，现在 Redis用在缓存的场合非常多。 
- 2、排行榜 
  - 很多网站都有排行榜应用的，如京东的月度销量榜单、商品按时间的上新排行榜等。Redis提供的有序集合数据类构能实现各种复杂的排行榜应用。 
- 3、计数器
  -  什么是计数器，如电商网站商品的浏览量、视频网站视频的播放数等。为了保证数据实时效，每次浏览都得给+1，并发量高时如果每次都请求数据库操作无疑是种挑战和压力。Redis提供的incr命令来实现计数器功能，内存操作，性能非常好，非常适用于这些计数场景。
-  4、分布式会话 
  - 集群模式下，在应用不多的情况下一般使用容器自带的session复制功能就能满足，当应用增多相对复杂的系统中，一般都会搭建以Redis等内存数据库为中心的session服务，session不再由容器管理，而是由session服务及内存数据库管理。 如，单点登录
- 5、分布式锁
  -  在很多互联网公司中都使用了分布式技术，分布式技术带来的技术挑战是对同一个资源的并发访问，如全局ID、减库存、秒杀等场景，并发量不大的场景可以使用数据库的悲观锁、乐观锁来实现，但在并发量高的场合中，利用数据库锁来控制资源的并发访问是不太理想的，大大影响了数据库的性能。可以利用Redis的setnx功能来编写分布式的锁，如果设置返回1说明获取锁成功，否则获取锁失败，实际应用中要考虑的细节要更多。
-  6、社交网络
  -  点赞、踩、关注/被关注、共同好友等是社交网站的基本功能，社交网站的访问量通常来说比较大，而且传统的关系数据库类型不适合存储这种类型的数据，Redis提供的哈希、集合等数据结构能很方便的的实现这些功能。
-  7、最新列表 
  - Redis列表结构，LPUSH可以在列表头部插入一个内容ID作为关键字，LTRIM可用来限制列表的数量，这样列表永远为N个ID，无需查询最新的列表，直接根据ID去到对应的内容页即可。 
- 8、消息系统 
  - 消息队列是大型网站必用中间件，如ActiveMQ、 RabbitMQ、Kafka等流行的消息队列中间件，主要用于业务解耦、流量削峰及异步处理实时性低的业务。Redis提供了发布/订阅及阻塞队列功能，能实现一个简单的消息队列系统。另外，这个不能和专业的消息中间件相比。

### 3. Redis 有什么优势?

响应快。

高并发下给数据库做缓存，避免数据库撑不住

- 1、性能高，速度快 Redis命令执行速度非常快，官方给出的读写性能可以达到10W/秒。 

  为什么会如此之快呢? 有以下几个因素∶

  -  数据存储在内存中，直接与内存连接。
  - 由相对底层的C语言实现，离操作系统更近。
  - 实现源码很精湛，仅仅几万行代码，简单稳定。 
  - 使用了单线程模型，无多线程竞争、锁等问题。 

- 2、丰富的数据结构 Redis与其他的内存数据库不同的是，Redis拥有丰富的数据类型，如字符串、哈希、列表、集合、有序集合等。正是因为Redis丰富的数据类型，所有它能应用的场景非常多。

-  3、丰富的特性 除了支持丰富的数据结构外，还支持以下高级功能。

  -  支持键过期功能，可以用来实现定时缓存。
  - 支持发布/订阅功能，可以有来实现消息队列。
  - 支持事务功能，可以保证多条命令的事务性。
  - 支持供管道功能，能够批量处理命令。
  - 支持Lua脚本功能。 
  - 支持集群分片和数据复制功能。
  - 支持内存数据持久化硬盘功能。

-  4、丰富的客户端 

  >   http∶//www.redis.cn/clients.html 

  从官网给出的客户端列表可以看出，各种各种的语言都能接入到Redis，接入包括了所有的主流开发语言。

   目前使用Redis的公司非常多，国内外都有很多重量级的公司在用。所以，现在学习Redis是大势所趋，学好Redis能为自己在日后的工作谋生中增加一个强有利的竞争手段。

### 4. Redis 为什么这么快?

(一)纯内存操作
(二)单线程操作，避免了频繁的上下文切换
(三)采用了非阻塞I/O多路复用机制。使用了单线程来轮询描述符，将数据库的开、关、读、写都转换成了事件，减少了线程切换时上下文的切换和竞争。

- 数据存储在内存中，直接与内存连接。

- 由相对底层的C语言实现，离操作系统更近。

- 实现源码很精湛，仅仅几万行代码，简单稳定。 

- 使用了单线程模型，无多线程竞争、锁等问题。

### 5. Redis 主要消耗什么物理资源?

内存

因为redis的数据都是存储在内存当中。内存数据库相比一般的关系型数据库，读取速度要更快，但是消耗的内存资源会更多。

### 6.Redis 为什么把所有数据放到内存中?

因为 Redis 的定位就是一个<font color='red'>内存数据库</font>。<font color='red'> 内存的读取速度是最快的</font>，如果放到硬盘，磁盘 IO 的速度势必会严重影响 Redis 的性能，那就和一般的关系数据库相比没什么优势可言，而且随着现在内存硬件成本的降低，内存已经不是问题，性能才是关键，现在硬盘只是成为了一种持久化方案而已。

Redis为了达到最快的读写速度将数据都读到内存中，并通过异步的方式将数据写入磁盘。所以Redis具有快速和数据持久化的特性。

如果不将数据放到内存中，磁盘的I/O速度会严重影响redis的性能。在内存越来越便宜的今天，redis将会越来越受欢迎。如果设置了最大使用的内存，则数据已有记录数达到内存限值后将不能继续插入新值。

### 7.Redis 命令是原子性的吗?

是。因为Redis的单线程

### 8.Redis 怎么测试连通性?

ping命令。

### 9.Redis 到底是单线程还是多线程?

单线程

### 10.Redis 和 Memcache 有什么区别?

最主要的几个区别∶ 

- 1、存储方式 Redis 支持数据持久性，可以持久化数据到硬盘上。 Memecache 把数据全部存在内存之中，断电后会挂掉，数据不能超过内存大小。 
- 2、数据类型 Redis 有丰富的数据结构，Memecache 只支持简单的字符串类型。
-  3、数据大小 Redis 单 个 value 的 最 大 限 制 是 512M， Memcached 最大限制是 1MB。 但是 Memcache 在存储 100K 以上的数据，性能稍微好一点。

Redis是单线程的的IO复用模型，对于单存只有IO操作来说，单线程可以将速度优势发挥到最大，但对于一些计算功能单线程模型会影响整体的吞吐量。memcache是多线程的，非阻塞IO复用的网络模型，分为监听主线程和worker子线程，多线程可以发挥多核优势，但加锁带来了性能损耗。

### 11.Redis 支持哪些数据类型?

string(字符串)、list(链表)、set(集合)、zset(sorted set --有序集合)和hash（哈希类型）。

### 12.Redis 默认支持多少个数据库?怎么修改?

Redis默认支持16个数据库，可以通过调整Redis的配置文件redis/redis.conf中的databases来修改这一个值，设置完毕后重启Redis便完成配置。

客户端与Redis建立连接后会默认选择0号数据库，不过可以随时使用SELECT命令更换数据库。

### 13.Redis 最大 key 大小?

Key的大小上限为512M。

建议key的大小不超过1KB，这样既节约存储空间，也利于Redis进行检索。

### 14.Redis String 值最大存储多少?

String类型的value值上限为512M。

![image-20210929002638537](https://note-java.oss-cn-beijing.aliyuncs.com/img/image-20210929002638537.png)

### 15.Redis 事务有什么用?

Redis事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。

Redis事务的主要作用就是<font color='red'>串联多个命令防止别的命令插队</font>。

### 16.Redis 事务相关的命令有哪几个?

Multi、Exec、discard

### 17.Redis 事务是原子性的吗?

> https://blog.51cto.com/u_14799494/2490313

### 18.Redis 持久化有什么用?

- 持久化就是把内存的数据写到磁盘中去，防止服务宕机了内存数据丢失。

### 19.Redis 有哪几种持久化方式?

1. AOF
2. RDB

### 20.Redis 持久化方式如何选择?

- 官方推荐两个都启用。
- 如果对数据不敏感，可以选单独用RDB。
- 不建议单独用 AOF，因为可能会出现Bug。
- 如果只是做纯内存缓存，可以都不用。 

### 21.如何保证 Redis 中的数据都是热点数据?

> https://blog.csdn.net/u013308490/article/details/87737810

将淘汰策略为volatile-lru或者allkeys-lru。 

### 22.Redis 内存满了怎么办?

- 增加内存；maxmemory

- 使用内存淘汰策略。maxmemory-policy

- Redis集群。

### 23.Redis 怎么配置最大内存容量?

`maxmemory`

### 24.Redis 有哪些淘汰策略?

noeviction: 不删除策略。当达到最大内存限制时, 如果需要使用更多内存,则直接返回错误信息。（redis默认淘汰策略）

allkeys-lru: 在所有key中优先删除最近最少使用(less recently used ,LRU) 的 key。

allkeys-random: 在所有key中随机删除一部分 key。

allkeys-lfu

volatile-lru: 在设置了超时时间（expire ）的key中优先删除最近最少使用(less recently used ,LRU) 的 key。

volatile-random: 在设置了超时时间（expire）的key中随机删除一部分 key。

volatile-ttl: 在设置了超时时间（expire ）的key中优先删除剩余时间(time to live,TTL) 短的key。

volatile-lfu

> https://www.cnblogs.com/lifan1998/p/15001630.html

redis并不会准确地删除所有键中最近最少使用的键，而是随机抽取n个键，删除这n个键中最近最少使用的键。这个n也是可以设置的，对应位置是配置文件中的**maxmeory-samples。**

### 25.Redis 为什么新增了LFU 淘汰策略?

https://www.cnblogs.com/linxiyue/p/10945216.html

https://www.cnblogs.com/linxiyue/p/10955533.html

### 26.Redis 淘汰策略LRU 和 LFU 的区别?

https://www.jianshu.com/p/c8aeb3eee6bc

### 27. Redis 怎么配置淘汰策略?

```
maxmemory-policy 淘汰策略
```

### 28.Redis 过期键的删除策略有哪些?

- 定时删除：在设置键的过期时间的同时，创建一个定时器，达到过期时间，执行键的删除操作
- 惰性删除：不主动删除过期键，从键空间中获取键时，都检查取得的键是否过期，过期则删除；没过期则返回
- 定期删除：每隔一段时间对数据库进行一次检查，删除里面的过期键。删除多少过期键、检查多少个数据库，由算法决定。

### 29.Redis 如何提高多核CPU利用率?

可以在同一个服务器部署多个Redis的实例，并把他们当作不同的服务器来使用，在某些时候，无论如何一个服务器是不够的， 所以，如果你想使用多个CPU，你可以考虑一下分片（shard）

### 30.Redis 如何实现大量数据插入?

Redis 2.6 开始 redis - cli 支持一种新的被称之为 pipe mode 的新模式用于执行大量数据插入工作。

一次请求/响应服务器能实现处理新的请求即使旧的请求还未被响应，这样就可以将多个命令发送到服务器，而不用等待回复，最后在一个步骤中读取该答复。

这就是管道（pipeline），是一种几十年来广泛使用的技术。例如许多 POP3 协议已经实现支持这个功能，大大加快了从服务器下载新邮件的过程。

### 31.Redis 的回收进程如何工作的?

一个客户端运行了新的命令，添加了新的数据。 redis检查内存使用情况，如果大于maxmemory的限制，则根据设定好的策略进行回收。

一个新的命令被执行等等，所以我们不断地穿越内存限制的边界，通过不断达到边界然后不断回收回到 边界以下。

如果一个命令的结果导致大量内存被使用(例如很大的集合的交集保存到一个新的键)，不用多久内存限制就会被这个内存使用量超越。 

### 32.Redis 中的管道有什么用?

管道技术(Pipeline)是客户端提供的一种批处理技术，用于<font color='red'>一次处理多个Redis命令</font>，从而提高整个交互的性能。

通常情况下Redis是单线程执行的，客户端先向服务器发送请求，服务端接收并处理请求、然后把结果返回给客户端，这种处理模式在非频繁请求时不会出现任何问题。

但如果出现集中大批量请求时，因为每个请求都要经历先请求再响应的过程，这就会造成网络资源浪费。此时就需要管道技术来把所有的命令整合起来，一次性发送给服务端，服务端处理完毕之后一次性响应给客户端，这样就大大地提高了Redis的响应速度。

> https://www.cnblogs.com/traditional/p/13304860.html

33.Redis 有哪些高可用方案?

- 主从复制
- 哨兵模式
- 集群

> https://www.jianshu.com/p/5de2ab291696

### 34.Redis 集群如何选择数据库?

Redis 集群目前无法做数据库选择，默认在 0 数据库。

### 35.Redis 哈希槽怎么理解?

Redis 集群没有使用一致性 hash，而是引入了哈希槽的概念。

Redis 集群有 16384 个哈希槽，每个 key 通过 CRC16 算法计算的结果，对 16384 取模后放到对应的编号在 0-16383 之间的哈希槽，集群的每个节点负责一部分哈希槽

[为什么Redis集群有16384个槽](https://www.cnblogs.com/rjzheng/p/11430592.html)

### 36.Redis 支持的 Java 客户端有哪些?

- Redisson
- Jedis
- Lettuce

### 37.Redisson 是什么框架?

Redisson是Redis服务器上的分布式可伸缩Java数据结构----驻内存数据网格(In-Memory Data Grid，IMDG)。底层使用netty框架，并提供了与java对象相对应的分布式对象、分布式集合、分布式锁和同步器、分布式服务等一系列的Redisson的分布式对象。

Redisson在Redis的基础上实现了java缓存标准规范；Redisson还提供了Spring Session回话管理器的实现。

> https://www.jianshu.com/p/8853b34f7c8b 

### 38.Redis 和 Redisson有什么关系?

Redisson是一个高级的分布式协调Redis客服端，能帮助用户在分布式环境中轻松实现一些Java的对象 (Bloom filter, BitSet, Set, SetMultimap, ScoredSortedSet, SortedSet, Map, ConcurrentMap, List, ListMultimap, Queue, BlockingQueue, Deque, BlockingDeque, Semaphore, Lock, ReadWriteLock, AtomicLong, CountDownLatch, Publish / Subscribe, HyperLogLog)。

### 39.Jedis、lettuce和Redisson 对比有什么优缺点?

**1. Jedis**

```
github: github.com/xetorthio/j…
```

Jedis是Redis的Java实现的客户端，其API提供了比较全面的Redis命令的支持。支持基本的数据类型如：String、Hash、List、Set、Sorted Set。

优点：比较全面的提供了Redis的操作特性，相比于其他Redis 封装框架更加原生。

编程模型： 使用阻塞的I/O，方法调用同步，程序流需要等到socket处理完I/O才能执行，不支持异步操作。Jedis客户端实例不是线程安全的，所以需要通过连接池来使用Jedis。

**2. Lettuce**

```
官网：lettuce.io/
github: github.com/lettuce-io/…
```

高级Redis客户端，用于线程安全同步，异步和响应使用，支持集群，Sentinel，管道和编码器。

优点：适合分布式缓存框架。

编程模型：基于Netty框架的事件驱动的通信层，其方法调用是异步的。Lettuce的API是线程安全的，所以可以操作单个Lettuce连接来完成各种操作。

**3.Redisson**

```
官网： redisson.org/
github: github.com/redisson/re…
```

Redisson实现了分布式和可扩展的Java数据结构。Redisson不仅提供了一系列的分布式Java常用对象，基本可以与Java的基本数据结构通用，还提供了许多分布式服务。

优点： 促使使用者对Redis的关注分离，让使用者能够将精力更集中地放在处理业务逻辑上，提供很多分布式相关操作服务，例如，分布式锁，分布式集合，可通过Redis支持延迟队列。

**第三方框架整合：**

提供了和Spring框架的各项特性类似的，以Spring XML的命名空间的方式配置RedissonClient实例和它所支持的所有对象和服务

在Redis的基础上实现了Java缓存标准规范，并完整的实现了Spring框架里的缓存机制

提供了Spring Session会话管理器的实现

编程模型：基于Netty框架的事件驱动的通信层，其方法调用是异步的。Redisson的API是线程安全的，所以可以操作单个Redisson连接来完成各种操作。

**4.总结**

Jedis中的方法调用是比较底层的暴露的Redis的API，也即Jedis中的Java方法基本和Redis的API保持着一致，了解Redis的API，也就能熟练的使用Jedis。而Redisson中的方法则是进行比较高的抽象，每个方法调用可能进行了一个或多个Redis方法调用。

### 40.Redis 为什么不提供Windows版本?

因为目前 Linux 版本已经相当稳定，且Linux操作系统自带的epoll相关函数, 在高并发情况下性能一般比windows的select函数性能较好，为了高性能起见, Redis官网不提供windows 版本。

### 41.Redis 如何设置密码访问?

**设置**

1. 在 /etc/redis.conf 配置文件下，需要重启服务生效。

```
requirepass 密码
```

2. 也可在客户端登录后再设置，此方式不需要重启服务就能生效，但是服务器重启后还是会优先使用配置文件中的密码。

```java
config set requirepass 密码
```

**访问**

1. 客户端登录时 -a 参数输入认证密码 ，

```
 ./redis-cli -h 主机 -p 端口号 -a 密码
```

2. 不使用 -a

```
./redis-cli -h 主机 -p 端口号
127.0.0.1:6379> auth 认证密码
```

**在Redis集群中使用认证密码**

如果Redis服务器，使用了集群。除了在master中配置密码外，也需要在slave中进行相应配置。在slave的配置文件中找到如下行，去掉注释并修改与master相同的密码即可：

```
 masterauth master-password
```

### 42.Redis 如何分析慢查询操作?

https://www.cnblogs.com/javastack/p/9632791.html

### 43.什么是缓存预热?

新的缓存系统没有任何缓存数据，在缓存重建数据的过程中，系统性能和数据库负载都不太好，所以最好是在系统上线之前就把要缓存的热点数据加载到缓存中，这种缓存预加载手段就是预热。

### 44.什么是缓存热备?

缓存热备即当一台服务器不可用时能实时切换到备用缓存服务器，不影响缓存使用。集群模式下，每个主节点都会有一个或多个从几点来当备用，一旦主节点挂掉，从节点立即充当主节点使用。

### 45.什么是缓存雪崩、缓存穿透、缓存击穿?



https://blog.csdn.net/a745233700/article/details/88088669

### 46.什么是缓存抖动?如何解决缓存抖动?

缓存抖动，一般是指由于某个<font color='red'>缓存节点故障</font>导致该节点上的缓存数据不可用.

推荐的做法是通过一致性 Hash 算法来解决。

### 47.什么是缓存无底洞?如何解决缓存无底洞?

为了满足业务大量加节点，但是性能没提升反而下降。

- 分布式缓存数据量特别大时，批量获取多个key由于分布在多个不同实例，需要多次网络IO，性能下降。
- 解决方案：
  - 串行`MGET`，将N个key拆解为N次`GET`操作。实现简单，性能较低。
  - 串行IO，计算每个key对应的节点，分别访问对应的节点。实现简单，性能较低。
  - 并行IO，将串行IO的网络请求改为多线程执行，实现复杂，性能较好。
  - hash-tag，强制将多个key分配到一个节点上，性能最高，但维护成本高，容易出现数据倾斜。

### 48.如何解决 Redis 和数据库双写一致性问题?

- 在同一时刻，Redis和DB中的数据不一致。
- 解决方案：
  - 如果不要求强一致性，只要保证最终一致性，可以给key设置较短的过期时间。
  - 先删缓存，再更新数据库。这样可能产生的问题：线程1删除缓存，线程2读取数据库并写入缓存，线程1更新数据库，此时缓存中缓存了脏数据。因此，需要延时双删等策略防止脏数据。
  - 先更新数据库，再删除缓存。这里可能由于删缓存失败导致产生脏数据。解决方法：使用消息队列不断重试确保删除缓存成功；订阅DB的binlog，尝试删除缓存，如果失败放入消息队列不断重试。

### 56.Redis 有哪些危险命令?如何防范?

### 57.Redis 如何统计独立用户访问量?

